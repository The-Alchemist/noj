<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>10&nbsp; Visualizing correlation matrices (experimental üõ†) - DRAFT ‚Äì Scinojure Documentation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./noj_book.interactions_ols.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<meta property="og:image" content="https://scicloj.github.io/sci-cloj-logo-transparent.png">
<meta property="og:title" content="10&nbsp; Visualizing correlation matrices (experimental üõ†) - DRAFT ‚Äì Scinojure Documentation">
<meta property="og:description" content="">
<link rel="icon" href="data:,">


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./noj_book.datasets.html">Tutorials</a></li><li class="breadcrumb-item"><a href="./noj_book.visualizing_correlation_matrices.html"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Visualizing correlation matrices (experimental üõ†) - DRAFT</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Scinojure Documentation</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Preface</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Overview</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./noj_book.underlying_libraries.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Underlying libraries</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./noj_book.recommended_libraries.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Recommended libraries</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./noj_book.known_issues.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Known issues ‚ùó</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Tutorials</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./noj_book.datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Datasets</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./noj_book.ml_basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Machine learning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./noj_book.prepare_for_ml.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Machine learning specific functionality in <code>tech.ml.dataset</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./noj_book.automl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">AutoML using metamorph pipelines</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./noj_book.interactions_ols.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Ordinary least squares with interactions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./noj_book.visualizing_correlation_matrices.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Visualizing correlation matrices (experimental üõ†) - DRAFT</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#auxiliary-functions" id="toc-auxiliary-functions" class="nav-link active" data-scroll-target="#auxiliary-functions"><span class="header-section-number">10.1</span> Auxiliary functions</a></li>
  <li><a href="#computing-a-correlation-matrix-and-representing-it-as-a-dataset" id="toc-computing-a-correlation-matrix-and-representing-it-as-a-dataset" class="nav-link" data-scroll-target="#computing-a-correlation-matrix-and-representing-it-as-a-dataset"><span class="header-section-number">10.2</span> Computing a correlation matrix and representing it as a dataset:</a></li>
  <li><a href="#drawing-a-heatmap-using-echarts" id="toc-drawing-a-heatmap-using-echarts" class="nav-link" data-scroll-target="#drawing-a-heatmap-using-echarts"><span class="header-section-number">10.3</span> Drawing a heatmap using Echarts</a></li>
  <li><a href="#drawing-a-heatmap-using-cljplot" id="toc-drawing-a-heatmap-using-cljplot" class="nav-link" data-scroll-target="#drawing-a-heatmap-using-cljplot"><span class="header-section-number">10.4</span> Drawing a heatmap using cljplot</a></li>
  <li><a href="#drawing-a-heatmap-using-vega" id="toc-drawing-a-heatmap-using-vega" class="nav-link" data-scroll-target="#drawing-a-heatmap-using-vega"><span class="header-section-number">10.5</span> Drawing a heatmap using Vega</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./noj_book.datasets.html">Tutorials</a></li><li class="breadcrumb-item"><a href="./noj_book.visualizing_correlation_matrices.html"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Visualizing correlation matrices (experimental üõ†) - DRAFT</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Visualizing correlation matrices (experimental üõ†) - DRAFT</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<style></style>
<style>.printedClojure .sourceCode {
  background-color: transparent;
  border-style: none;
}
</style>
<style>.clay-limit-image-width .clay-image {max-width: 100%}
.clay-side-by-side .sourceCode {margin: 0}
.clay-side-by-side {margin: 1em 0}
</style>
<script src="noj_book.visualizing_correlation_matrices_files/md-default0.js" type="text/javascript"></script>
<script src="noj_book.visualizing_correlation_matrices_files/md-default1.js" type="text/javascript"></script>
<script src="noj_book.visualizing_correlation_matrices_files/echarts2.js" type="text/javascript"></script>
<p>This tutorial explores various ways to visualize a correlation matrix as a heatmap. It is inspired by the discussion at the <a href="https://scicloj.github.io/docs/community/chat/">Clojurians Zulip chat</a>: <a href="https://clojurians.zulipchat.com/#narrow/stream/151924-data-science/topic/correlation.20matrix.20plot.20.3F">#data-science &gt; correlation matrix plot ?</a></p>
<p>author: Daniel Slutsky</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb1"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">ns</span> noj-book.visualizing-correlation-matrices</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  (<span class="at">:require</span> [fastmath.stats]</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>            [fastmath.core <span class="at">:as</span> fastmath]</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>            [tablecloth.api <span class="at">:as</span> tc]</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>            [noj-book.datasets]</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>            [scicloj.kindly.v4.kind <span class="at">:as</span> kind]</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>            [clojure.math <span class="at">:as</span> math]</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>            [clojure.string <span class="at">:as</span> <span class="kw">str</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="auxiliary-functions" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="auxiliary-functions"><span class="header-section-number">10.1</span> Auxiliary functions</h2>
<p>Rounding numbers:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb2"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">defn</span><span class="fu"> round</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  [n scale rm]</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  (.setScale ^java.math.BigDecimal (<span class="kw">bigdec</span> n)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>             (<span class="kw">int</span> scale)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>             ^RoundingMode (<span class="kw">if</span> (<span class="kw">instance?</span> java.math.RoundingMode rm)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>                             rm</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>                             (java.math.RoundingMode/valueOf</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>                              (<span class="kw">str</span> (<span class="kw">if</span> (ident? rm) (<span class="kw">symbol</span> rm) rm))))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For example (see <a href="https://docs.oracle.com/javase/8/docs/api/java/math/RoundingMode.html">RoundingMode</a>)</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb3"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>(round (<span class="kw">/</span> <span class="fl">2.0</span> <span class="dv">3</span>) <span class="dv">2</span> <span class="at">:DOWN</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb4"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fl">0.66M</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb5"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>(round (<span class="kw">/</span> <span class="fl">2.0</span> <span class="dv">3</span>) <span class="dv">2</span> <span class="at">:UP</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb6"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fl">0.67M</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb7"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>(round (<span class="kw">/</span> <span class="fl">2.0</span> <span class="dv">3</span>) <span class="dv">2</span> <span class="at">:HALF</span>_EVEN)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb8"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fl">0.67M</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="computing-a-correlation-matrix-and-representing-it-as-a-dataset" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="computing-a-correlation-matrix-and-representing-it-as-a-dataset"><span class="header-section-number">10.2</span> Computing a correlation matrix and representing it as a dataset:</h2>
<div class="sourceClojure">
<div class="sourceCode" id="cb9"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">defn</span><span class="fu"> correlations-dataset </span>[data columns-to-use]</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">let</span> [matrix (<span class="kw">-&gt;&gt;</span> columns-to-use</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                    (<span class="kw">mapv</span> #(<span class="kw">get</span> data <span class="va">%</span>))</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                    fastmath.stats/correlation-matrix)]</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    (<span class="kw">-&gt;&gt;</span> matrix</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>         (map-indexed</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>          (<span class="kw">fn</span> [i row]</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>            (<span class="kw">let</span> [coli (columns-to-use i)]</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>              (<span class="kw">-&gt;&gt;</span> row</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>                   (map-indexed</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>                    (<span class="kw">fn</span> [j corr]</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>                      (<span class="kw">let</span> [colj (columns-to-use j)]</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>                        {<span class="at">:i</span> i</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>                         <span class="at">:j</span> j</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>                         <span class="at">:coli</span> coli</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>                         <span class="at">:colj</span> colj</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>                         <span class="at">:corr</span> corr</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>                         <span class="at">:corr-round</span> (round corr <span class="dv">2</span> <span class="at">:HALF</span>_EVEN)})))))))</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>         (<span class="kw">apply</span> <span class="kw">concat</span>)</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>         tc/dataset)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For example:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb10"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> noj-book.datasets/iris</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    (correlations-dataset [<span class="at">:sepal-length</span> <span class="at">:sepal-width</span> <span class="at">:petal-length</span> <span class="at">:petal-width</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [16 6]:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: right;">:i</th>
<th style="text-align: right;">:j</th>
<th>:coli</th>
<th>:colj</th>
<th style="text-align: right;">:corr</th>
<th>:corr-round</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td>:sepal-length</td>
<td>:sepal-length</td>
<td style="text-align: right;">1.00000000</td>
<td>1.000</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td>:sepal-length</td>
<td>:sepal-width</td>
<td style="text-align: right;">-0.11756978</td>
<td>-0.1200</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td>:sepal-length</td>
<td>:petal-length</td>
<td style="text-align: right;">0.87175378</td>
<td>0.8700</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td>:sepal-length</td>
<td>:petal-width</td>
<td style="text-align: right;">0.81794113</td>
<td>0.8200</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td>:sepal-width</td>
<td>:sepal-length</td>
<td style="text-align: right;">-0.11756978</td>
<td>-0.1200</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td>:sepal-width</td>
<td>:sepal-width</td>
<td style="text-align: right;">1.00000000</td>
<td>1.000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td>:sepal-width</td>
<td>:petal-length</td>
<td style="text-align: right;">-0.42844010</td>
<td>-0.4300</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td>:sepal-width</td>
<td>:petal-width</td>
<td style="text-align: right;">-0.36612593</td>
<td>-0.3700</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td>:petal-length</td>
<td>:sepal-length</td>
<td style="text-align: right;">0.87175378</td>
<td>0.8700</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td>:petal-length</td>
<td>:sepal-width</td>
<td style="text-align: right;">-0.42844010</td>
<td>-0.4300</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td>:petal-length</td>
<td>:petal-length</td>
<td style="text-align: right;">1.00000000</td>
<td>1.000</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td>:petal-length</td>
<td>:petal-width</td>
<td style="text-align: right;">0.96286543</td>
<td>0.9600</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td>:petal-width</td>
<td>:sepal-length</td>
<td style="text-align: right;">0.81794113</td>
<td>0.8200</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td>:petal-width</td>
<td>:sepal-width</td>
<td style="text-align: right;">-0.36612593</td>
<td>-0.3700</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td>:petal-width</td>
<td>:petal-length</td>
<td style="text-align: right;">0.96286543</td>
<td>0.9600</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td>:petal-width</td>
<td>:petal-width</td>
<td style="text-align: right;">1.00000000</td>
<td>1.000</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="drawing-a-heatmap-using-echarts" class="level2" data-number="10.3">
<h2 data-number="10.3" class="anchored" data-anchor-id="drawing-a-heatmap-using-echarts"><span class="header-section-number">10.3</span> Drawing a heatmap using Echarts</h2>
<p>The following function is inspired by <a href="https://github.com/apache/echarts/blob/master/test/heatmap-large.html">an Apache Echarts heatmap tutorial</a>.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb11"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">defn</span><span class="fu"> echarts-heatmap </span>[{<span class="at">:keys</span> [xyz-data xs ys</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>                               <span class="kw">min</span> <span class="kw">max</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>                               series-name]</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">:or</span> {series-name <span class="st">""</span>}}]</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  (kind/echarts</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>   {<span class="at">:tooltip</span> {}</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">:xAxis</span> {<span class="at">:type</span> <span class="at">:category</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">:data</span> xs}</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">:yAxis</span> {<span class="at">:type</span> <span class="at">:category</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">:data</span> ys}</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">:visualMap</span> {<span class="at">:min</span> <span class="kw">min</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">:max</span> <span class="kw">max</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">:calculable</span> <span class="va">true</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">:splitNumber</span> <span class="dv">8</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">:inRange</span> {<span class="at">:color</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>                          [<span class="st">"#313695"</span> <span class="st">"#4575b4"</span> <span class="st">"#74add1"</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"#abd9e9"</span> <span class="st">"#e0f3f8"</span> <span class="st">"#ffffbf"</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"#fee090"</span> <span class="st">"#fdae61"</span> <span class="st">"#f46d43"</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"#d73027"</span> <span class="st">"#a50026"</span>]}}</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">:series</span> [{<span class="at">:name</span> series-name</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>              <span class="at">:type</span> <span class="at">:heatmap</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>              <span class="at">:data</span> xyz-data</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>              <span class="at">:itemStyle</span> {<span class="at">:emphasis</span> {<span class="at">:borderColor</span> <span class="st">"#333"</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">:borderWidth</span> <span class="dv">2</span>}}</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>              <span class="at">:progressive</span> <span class="dv">1000</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>              <span class="at">:animation</span> <span class="va">false</span>}]}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here is an example using synthetic data:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb12"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">let</span> [n <span class="dv">30</span>]</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  (echarts-heatmap</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>   {<span class="at">:xyz-data</span> (<span class="kw">for</span> [i (<span class="kw">range</span> n)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>                    j (<span class="kw">range</span> n)]</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>                [i j (fastmath/logistic (<span class="kw">*</span>  (<span class="kw">+</span> (<span class="kw">-</span> i j))</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>                                            (<span class="kw">rand</span>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>                                            (<span class="kw">/</span> <span class="dv">2</span> (<span class="kw">double</span> n))))])</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">:x-data</span> (<span class="kw">range</span> n)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">:y-data</span> (<span class="kw">range</span> n)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">:min</span> <span class="dv">0</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">:max</span> <span class="dv">1</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div style="height:400px;width:100%;"><script>
{
  var myChart = echarts.init(document.currentScript.parentElement);
  myChart.setOption({"tooltip":{},"xAxis":{"type":"category","data":null},"yAxis":{"type":"category","data":null},"visualMap":{"min":0,"max":1,"calculable":true,"splitNumber":8,"inRange":{"color":["#313695","#4575b4","#74add1","#abd9e9","#e0f3f8","#ffffbf","#fee090","#fdae61","#f46d43","#d73027","#a50026"]}},"series":[{"name":"","type":"heatmap","data":[[0,0,0.5],[0,1,0.49850013087107536],[0,2,0.4879886737942856],[0,3,0.47184360118243984],[0,4,0.48372164367834647],[0,5,0.44621990298482284],[0,6,0.43105063895002216],[0,7,0.3965615228235999],[0,8,0.44017144903228],[0,9,0.4513689299757697],[0,10,0.47460208637665874],[0,11,0.34800617817074736],[0,12,0.4411451928712907],[0,13,0.3098583066615696],[0,14,0.33058429393506283],[0,15,0.3373519087340489],[0,16,0.4164409486480458],[0,17,0.39303742644436235],[0,18,0.2613598257956591],[0,19,0.23637978425066508],[0,20,0.45533520228267343],[0,21,0.29122754487980024],[0,22,0.2676560162138611],[0,23,0.1864031018396732],[0,24,0.37304962042327916],[0,25,0.2924473397284631],[0,26,0.2939430396919461],[0,27,0.14643179460268585],[0,28,0.4872789173519875],[0,29,0.39656384973281683],[1,0,0.5058456136909931],[1,1,0.5],[1,2,0.4842649212476145],[1,3,0.4976157887580567],[1,4,0.45101778822294547],[1,5,0.47886766378898876],[1,6,0.46899628647110597],[1,7,0.44961142863689657],[1,8,0.4781018873158564],[1,9,0.37396422898656173],[1,10,0.465643991882574],[1,11,0.3735258861523963],[1,12,0.47509383045393005],[1,13,0.4047268602155403],[1,14,0.37165966746391743],[1,15,0.45313714085550777],[1,16,0.4568045859674563],[1,17,0.27919770696528323],[1,18,0.4334029814042585],[1,19,0.4844862837135328],[1,20,0.26939737571334993],[1,21,0.2927918132529007],[1,22,0.35594220977790614],[1,23,0.258335277402883],[1,24,0.26993962392616666],[1,25,0.30940519756879076],[1,26,0.3491211480392523],[1,27,0.2278535723824591],[1,28,0.26814261298411757],[1,29,0.4004065073566971],[2,0,0.5202139942635151],[2,1,0.5060410662230798],[2,2,0.5],[2,3,0.48558117260705863],[2,4,0.4971362803572849],[2,5,0.4836104033525628],[2,6,0.47291008263304113],[2,7,0.46056041923933067],[2,8,0.40297904440262317],[2,9,0.497774287526436],[2,10,0.45681797226663445],[2,11,0.39403520275310755],[2,12,0.4113612432543782],[2,13,0.3810156701240888],[2,14,0.47400443866806435],[2,15,0.46604930605856254],[2,16,0.4286356392781832],[2,17,0.30720723765202346],[2,18,0.41974382515438485],[2,19,0.2843513885161212],[2,20,0.43889908909334635],[2,21,0.35702021769573256],[2,22,0.408103128225065],[2,23,0.4732792256648574],[2,24,0.46019568882474265],[2,25,0.34761580168456097],[2,26,0.4597441758607569],[2,27,0.41691409405121665],[2,28,0.2833485393446934],[2,29,0.2109369052141592],[3,0,0.5113415070776969],[3,1,0.5325288248739605],[3,2,0.5127218466994892],[3,3,0.5],[3,4,0.4848314953056122],[3,5,0.48639574415725556],[3,6,0.49561354424465076],[3,7,0.4783065440749036],[3,8,0.47016521093336255],[3,9,0.4350252702111029],[3,10,0.4578291595074495],[3,11,0.4273475877262349],[3,12,0.44246351494260383],[3,13,0.3647565373415849],[3,14,0.3560486831469769],[3,15,0.4383068212650458],[3,16,0.37307785648736114],[3,17,0.3381734542804546],[3,18,0.4675102990630325],[3,19,0.3552595994971824],[3,20,0.429254563153341],[3,21,0.275760729746543],[3,22,0.38897573672750224],[3,23,0.31007872534783865],[3,24,0.25641861585163084],[3,25,0.2742370199514907],[3,26,0.3352537939663486],[3,27,0.4847666142986205],[3,28,0.2801114699726104],[3,29,0.45636881505005106],[4,0,0.5427689407575225],[4,1,0.5348121041868914],[4,2,0.514215965489907],[4,3,0.5010624360861972],[4,4,0.5],[4,5,0.4898884355600372],[4,6,0.4842707631976663],[4,7,0.4554256670224445],[4,8,0.43492745067393507],[4,9,0.44938842823592207],[4,10,0.46538909898838765],[4,11,0.4891415944601894],[4,12,0.3882797385472561],[4,13,0.4788520919309798],[4,14,0.4113376044734875],[4,15,0.42601959366135755],[4,16,0.39668078119192446],[4,17,0.44580568745425514],[4,18,0.37123782979325276],[4,19,0.3328142715862291],[4,20,0.3754159761769113],[4,21,0.24481436824202593],[4,22,0.48753415620234614],[4,23,0.27440135828325535],[4,24,0.23529868967057727],[4,25,0.21967398896123272],[4,26,0.24890131094940549],[4,27,0.4772380050118756],[4,28,0.49666549972978646],[4,29,0.34014603833830825],[5,0,0.565385774188646],[5,1,0.5547026115454095],[5,2,0.50545519910618],[5,3,0.518463680739184],[5,4,0.5079532158551412],[5,5,0.5],[5,6,0.48696097358380064],[5,7,0.4670605460323368],[5,8,0.48427130102772187],[5,9,0.43952489667673783],[5,10,0.4654707072224007],[5,11,0.48527962283529213],[5,12,0.4582060578378116],[5,13,0.4651473943035234],[5,14,0.4353537939119676],[5,15,0.39266449929764163],[5,16,0.3979508770884821],[5,17,0.3372121662488649],[5,18,0.4273800581907104],[5,19,0.4706162942799202],[5,20,0.409434870063399],[5,21,0.37712626502162555],[5,22,0.4773855109937094],[5,23,0.4641875164280992],[5,24,0.37306275665364996],[5,25,0.3045804231905885],[5,26,0.42494334848065635],[5,27,0.24481291077615103],[5,28,0.2553711974287353],[5,29,0.22311833833878345],[6,0,0.5392837837132776],[6,1,0.5002974414762226],[6,2,0.5389447265040711],[6,3,0.5295164381134445],[6,4,0.5055579551188009],[6,5,0.5028038911404956],[6,6,0.5],[6,7,0.48873199244805615],[6,8,0.4723292353283059],[6,9,0.48760056566302723],[6,10,0.4400407846145894],[6,11,0.4892089521703148],[6,12,0.4055160017527422],[6,13,0.3937573338028426],[6,14,0.39383896638410687],[6,15,0.3938098841468503],[6,16,0.40716434298115256],[6,17,0.4754156734604885],[6,18,0.3378630092814667],[6,19,0.499760346957889],[6,20,0.3994996344430715],[6,21,0.3006614962664957],[6,22,0.3287590731825877],[6,23,0.3086279348618513],[6,24,0.25487737978026154],[6,25,0.40007014478275355],[6,26,0.24538130550124476],[6,27,0.20073893823338176],[6,28,0.3408209648880794],[6,29,0.4114498011074453],[7,0,0.5033281545700702],[7,1,0.5204712762168691],[7,2,0.5158854347900219],[7,3,0.5392625071407017],[7,4,0.5471528175795703],[7,5,0.5162677802663023],[7,6,0.5060653543393068],[7,7,0.5],[7,8,0.4833920509077364],[7,9,0.49315588495981694],[7,10,0.46865306028418835],[7,11,0.4824741122450984],[7,12,0.4527143364195712],[7,13,0.48764282535450226],[7,14,0.4246258871437013],[7,15,0.39618451842359986],[7,16,0.3923218707102228],[7,17,0.46266058611216004],[7,18,0.451659992188474],[7,19,0.41270251264791813],[7,20,0.38058945125329874],[7,21,0.36962623885727963],[7,22,0.45891759203367666],[7,23,0.2581106301433102],[7,24,0.3059279102774285],[7,25,0.4874508013482336],[7,26,0.4214377320152505],[7,27,0.3242031679948698],[7,28,0.22904207368453566],[7,29,0.439858109605233],[8,0,0.5040438822931463],[8,1,0.6119381517585901],[8,2,0.5490020929243574],[8,3,0.5674909538363927],[8,4,0.5125905597853673],[8,5,0.5429934721181958],[8,6,0.5129612669633066],[8,7,0.5163673139882726],[8,8,0.5],[8,9,0.4897988814225076],[8,10,0.4885925377169218],[8,11,0.4794051130838307],[8,12,0.4370020511513982],[8,13,0.4234972617474057],[8,14,0.4089938170019837],[8,15,0.4469096984567707],[8,16,0.39148321222813093],[8,17,0.41841874732045603],[8,18,0.4628319020698709],[8,19,0.48166260555311213],[8,20,0.4092492607879983],[8,21,0.47310032961093307],[8,22,0.44893444818461153],[8,23,0.32373138943602103],[8,24,0.2794629333709339],[8,25,0.36723762507627644],[8,26,0.2603108143813832],[8,27,0.22830051564762605],[8,28,0.4163982138343292],[8,29,0.25149043936173415],[9,0,0.5877345721276218],[9,1,0.5421815410164549],[9,2,0.5789322510770053],[9,3,0.5516527631360502],[9,4,0.5595957678946591],[9,5,0.5448973315432039],[9,6,0.5419385286680093],[9,7,0.5165039642991434],[9,8,0.5093766088208576],[9,9,0.5],[9,10,0.4891640839141743],[9,11,0.4832475761662333],[9,12,0.48454730687705333],[9,13,0.4643723400059678],[9,14,0.48813245964323376],[9,15,0.43054213741318853],[9,16,0.44062444055274846],[9,17,0.49892258110235044],[9,18,0.47744293254149517],[9,19,0.4488151559234897],[9,20,0.4712388295047119],[9,21,0.3382477842126451],[9,22,0.38162890255868087],[9,23,0.3745317185418202],[9,24,0.41796953036948414],[9,25,0.48676055391203993],[9,26,0.46780465739759813],[9,27,0.36217747710119064],[9,28,0.40407124127829824],[9,29,0.492635403336441],[10,0,0.5713907663930867],[10,1,0.5991126850673467],[10,2,0.5654355238942109],[10,3,0.6070941979881838],[10,4,0.5587086118439093],[10,5,0.5581850691653386],[10,6,0.5031184576391452],[10,7,0.5086034518957419],[10,8,0.5324093275263336],[10,9,0.5064788922741612],[10,10,0.5],[10,11,0.4935739328368838],[10,12,0.4884590203625022],[10,13,0.49566844399002463],[10,14,0.4662905569742568],[10,15,0.4341640963828454],[10,16,0.4117632709805518],[10,17,0.44938200246535676],[10,18,0.4005579996255517],[10,19,0.41799477064253254],[10,20,0.3495704573505247],[10,21,0.48672047046094025],[10,22,0.4786939427975687],[10,23,0.30210312171004644],[10,24,0.4319093337468674],[10,25,0.4319873638852253],[10,26,0.3908356602345323],[10,27,0.3408826988864851],[10,28,0.26291820060319204],[10,29,0.34159304618121944],[11,0,0.5161882612310715],[11,1,0.5413385167278444],[11,2,0.5942147742952226],[11,3,0.5695617829741787],[11,4,0.5539743108122556],[11,5,0.5525752615233045],[11,6,0.5685351013075803],[11,7,0.526886278669037],[11,8,0.5295063512441621],[11,9,0.5331926174759093],[11,10,0.5125284590537046],[11,11,0.5],[11,12,0.4881793775052917],[11,13,0.49052520570114183],[11,14,0.4933989070065401],[11,15,0.49980189246724654],[11,16,0.49982289540068175],[11,17,0.4072198376626949],[11,18,0.47076261865123614],[11,19,0.44221442701866887],[11,20,0.4861621480246024],[11,21,0.40354726588234036],[11,22,0.3779768713021699],[11,23,0.3846889694606431],[11,24,0.38199635502635615],[11,25,0.46521644163738585],[11,26,0.3066931236677936],[11,27,0.3280818536406299],[11,28,0.43685889182393534],[11,29,0.40745612870166026],[12,0,0.553393699146815],[12,1,0.6718678753907362],[12,2,0.5648008501267057],[12,3,0.6195319631582281],[12,4,0.5253051469205029],[12,5,0.5550636113460671],[12,6,0.5094227635044487],[12,7,0.5500573702105974],[12,8,0.5027689397758579],[12,9,0.5255474024107094],[12,10,0.5187833179619012],[12,11,0.5063998069358311],[12,12,0.5],[12,13,0.48468256044103714],[12,14,0.48164533755796135],[12,15,0.4729000588671827],[12,16,0.48164523232111844],[12,17,0.47980149432394464],[12,18,0.4297412609516608],[12,19,0.4950198440858813],[12,20,0.380503176232353],[12,21,0.3873580041551178],[12,22,0.4339645601879635],[12,23,0.4248472916023081],[12,24,0.325828159952327],[12,25,0.4070831835563447],[12,26,0.42166402425991995],[12,27,0.3638351305678359],[12,28,0.49523693568582494],[12,29,0.28466452572416123],[13,0,0.5458411623708018],[13,1,0.6491695355683317],[13,2,0.5872042458687731],[13,3,0.6095904527612986],[13,4,0.5028828841536903],[13,5,0.624656305083297],[13,6,0.5337107260220899],[13,7,0.5898661983436779],[13,8,0.5178775494952237],[13,9,0.55601218927532],[13,10,0.5189452511608451],[13,11,0.5045984458713885],[13,12,0.5141383440648817],[13,13,0.5],[13,14,0.49821476215304333],[13,15,0.49249443788764413],[13,16,0.45932711644060603],[13,17,0.4978233512908474],[13,18,0.4528064734816825],[13,19,0.4080809181875007],[13,20,0.49889251609680185],[13,21,0.42633993430775957],[13,22,0.39081095118564013],[13,23,0.367602785551545],[13,24,0.38174818072262956],[13,25,0.40767283422024797],[13,26,0.45768052694320893],[13,27,0.41330230992374845],[13,28,0.41532294841289097],[13,29,0.37527425711788903],[14,0,0.5304735530710295],[14,1,0.6240906470872944],[14,2,0.5543051280817265],[14,3,0.6630912224138745],[14,4,0.6225502990680298],[14,5,0.6148144226215965],[14,6,0.5219556615157396],[14,7,0.5185526091930115],[14,8,0.5646871499261125],[14,9,0.514524261345125],[14,10,0.5457552647291272],[14,11,0.5288608215612568],[14,12,0.522328238859048],[14,13,0.5015633161030977],[14,14,0.5],[14,15,0.4892692368343892],[14,16,0.47155758890486543],[14,17,0.48097932277792615],[14,18,0.4608711507307021],[14,19,0.47021759891722964],[14,20,0.4434554728172233],[14,21,0.4586543587753531],[14,22,0.4132936525729787],[14,23,0.41062170503679546],[14,24,0.41298233704328097],[14,25,0.47847481916789036],[14,26,0.3324199561686438],[14,27,0.3154815766922061],[14,28,0.38937622362604263],[14,29,0.2789437993819076],[15,0,0.6097371448278089],[15,1,0.5380124881107062],[15,2,0.6184022645543698],[15,3,0.5143410522920104],[15,4,0.6273220685767049],[15,5,0.5543310078809365],[15,6,0.6197013110714544],[15,7,0.5031671657770675],[15,8,0.5483335498019744],[15,9,0.5570481684796789],[15,10,0.5341506003517853],[15,11,0.5338049898700356],[15,12,0.5224270694019408],[15,13,0.5158979669673501],[15,14,0.5143004663579183],[15,15,0.5],[15,16,0.49313681770019496],[15,17,0.489726233413552],[15,18,0.48697678523752164],[15,19,0.4395333445924865],[15,20,0.42146491078077997],[15,21,0.48813574843191154],[15,22,0.48915158086659055],[15,23,0.46571489063897625],[15,24,0.369305007256046],[15,25,0.4137651721656793],[15,26,0.4927381013314914],[15,27,0.418266431461595],[15,28,0.45070259662621703],[15,29,0.4122446757682543],[16,0,0.6624350270487984],[16,1,0.5782211525187719],[16,2,0.6626909317408198],[16,3,0.6959673771442293],[16,4,0.6828532613147642],[16,5,0.5327631309291087],[16,6,0.5776335512763024],[16,7,0.5757034631902459],[16,8,0.5670840329723104],[16,9,0.5056516988897092],[16,10,0.5014485126128595],[16,11,0.5566598951184322],[16,12,0.5184112894407766],[16,13,0.5112615707447267],[16,14,0.5263482645142181],[16,15,0.508539509265512],[16,16,0.5],[16,17,0.49519435755412966],[16,18,0.48511256335309816],[16,19,0.48314851494001904],[16,20,0.4764597051954758],[16,21,0.47319013585315606],[16,22,0.4670329978196542],[16,23,0.4500094773605176],[16,24,0.374180202246067],[16,25,0.4468126913301509],[16,26,0.36429782892505436],[16,27,0.37820156116804166],[16,28,0.4447198751548265],[16,29,0.30445366687489056],[17,0,0.6418488689854939],[17,1,0.5615784406399076],[17,2,0.5591685525819042],[17,3,0.5800956477439095],[17,4,0.6827780293266392],[17,5,0.6251884087716267],[17,6,0.6071458254757174],[17,7,0.5841639240052247],[17,8,0.5910239054555301],[17,9,0.580739149085033],[17,10,0.5732033951240124],[17,11,0.5090466901244298],[17,12,0.5306285511218687],[17,13,0.5157052262449379],[17,14,0.5460989906126819],[17,15,0.5053655341325646],[17,16,0.5151818417121781],[17,17,0.5],[17,18,0.4900610554457969],[17,19,0.4879884866151909],[17,20,0.49005615834403576],[17,21,0.4369609300207569],[17,22,0.45691315041740216],[17,23,0.49041181833380365],[17,24,0.48759512750191336],[17,25,0.4094123382182558],[17,26,0.3544707859822014],[17,27,0.4779848417750653],[17,28,0.47826065006442803],[17,29,0.40229301615278973],[18,0,0.5016210158914033],[18,1,0.5215869827035381],[18,2,0.6974946862085458],[18,3,0.66935236786076],[18,4,0.6524882071132962],[18,5,0.6995912590650569],[18,6,0.6854929669873063],[18,7,0.5099457481184335],[18,8,0.6461333843591301],[18,9,0.573136372161206],[18,10,0.5066816396574356],[18,11,0.5332569284721527],[18,12,0.5082010945012614],[18,13,0.573175625908622],[18,14,0.553472024087985],[18,15,0.5205859898660282],[18,16,0.5216785312430223],[18,17,0.5059325266276998],[18,18,0.5],[18,19,0.485924985451122],[18,20,0.467568859232661],[18,21,0.4941034889275312],[18,22,0.4853701806181999],[18,23,0.4524674261643885],[18,24,0.4788854900954259],[18,25,0.39128303358874544],[18,26,0.4389385552369521],[18,27,0.4134996936474469],[18,28,0.45783481197923426],[18,29,0.34686138976308906],[19,0,0.7263022423979411],[19,1,0.7143163141961988],[19,2,0.644427515162587],[19,3,0.503163092814845],[19,4,0.566010180052473],[19,5,0.6327219263995691],[19,6,0.5875881437390781],[19,7,0.6530947875971959],[19,8,0.5579046639758461],[19,9,0.6538066412508756],[19,10,0.552043069109229],[19,11,0.5985685274116398],[19,12,0.5591645926020253],[19,13,0.5825404907229997],[19,14,0.5167986290538056],[19,15,0.5544340099246765],[19,16,0.5292789999677315],[19,17,0.5082920770164205],[19,18,0.5044733145776846],[19,19,0.5],[19,20,0.48727310677901575],[19,21,0.47783154462439237],[19,22,0.4742385660733814],[19,23,0.45662882371361374],[19,24,0.46610513029503914],[19,25,0.41933744714804083],[19,26,0.3942604411917925],[19,27,0.457371966401234],[19,28,0.428710767789544],[19,29,0.4381383571608237],[20,0,0.6657744832750356],[20,1,0.7581959039726892],[20,2,0.6029022761549132],[20,3,0.5526076597375854],[20,4,0.6781081292078125],[20,5,0.720892872541381],[20,6,0.6231838362706128],[20,7,0.501073967645823],[20,8,0.6078517103357999],[20,9,0.6559047610282998],[20,10,0.6172713158453679],[20,11,0.5175571217195516],[20,12,0.5658615708629925],[20,13,0.5849874884860004],[20,14,0.5766625236412737],[20,15,0.5494310761563018],[20,16,0.5272504433655235],[20,17,0.5173795709985076],[20,18,0.5053878733215923],[20,19,0.5052086047813443],[20,20,0.5],[20,21,0.48996910798000415],[20,22,0.474881653493661],[20,23,0.48360068632905423],[20,24,0.4377156073051266],[20,25,0.4320988947732848],[20,26,0.4670401382373063],[20,27,0.4177170466754308],[20,28,0.4498617425509956],[20,29,0.47842601846131433],[21,0,0.6699247445898294],[21,1,0.6289162435419438],[21,2,0.5169139723775754],[21,3,0.5635638553155566],[21,4,0.5901555041490041],[21,5,0.5463661308723471],[21,6,0.5563190529786904],[21,7,0.5804146141041097],[21,8,0.6931979643574842],[21,9,0.6079492404600235],[21,10,0.6175410846819469],[21,11,0.649160260104766],[21,12,0.6316268008186471],[21,13,0.5934326968942459],[21,14,0.5419917183716154],[21,15,0.5601141192576119],[21,16,0.5123669502273728],[21,17,0.5396407954263522],[21,18,0.503187372637975],[21,19,0.5212851527016201],[21,20,0.5113406533413388],[21,21,0.5],[21,22,0.4971593559493913],[21,23,0.48452473726599293],[21,24,0.4567087364350433],[21,25,0.4760193977940941],[21,26,0.42471489227546483],[21,27,0.4538634006943985],[21,28,0.4082562566741883],[21,29,0.4717767905513727],[22,0,0.5075607112264583],[22,1,0.7611860431588556],[22,2,0.7300929713981382],[22,3,0.742104167506376],[22,4,0.6717445595822211],[22,5,0.5424497214374202],[22,6,0.6806025883371226],[22,7,0.7102449056151653],[22,8,0.5390382956443308],[22,9,0.6073944704041745],[22,10,0.546302987551623],[22,11,0.6003412116492958],[22,12,0.6289016540034352],[22,13,0.580397295120021],[22,14,0.5276390569431086],[22,15,0.6023935302750852],[22,16,0.597000639173733],[22,17,0.5279125976552783],[22,18,0.5133787758965641],[22,19,0.5216619501768676],[22,20,0.5194497497717273],[22,21,0.5081724365182837],[22,22,0.5],[22,23,0.4863366481385412],[22,24,0.4910642917819215],[22,25,0.4831998925731105],[22,26,0.4562878665709971],[22,27,0.45329103165353046],[22,28,0.47774487777529207],[22,29,0.3990704636162646],[23,0,0.7371168719888483],[23,1,0.7903258497618757],[23,2,0.7288266209631482],[23,3,0.666022572124765],[23,4,0.5374189884804702],[23,5,0.7077578335423682],[23,6,0.6617492985230852],[23,7,0.6283278724735879],[23,8,0.7229162732475887],[23,9,0.6314746869997435],[23,10,0.6506438717645123],[23,11,0.5715779702268927],[23,12,0.5935237336845803],[23,13,0.6162658025332199],[23,14,0.6233649841623055],[23,15,0.6159629911533314],[23,16,0.5643242340807534],[23,17,0.56733053424996],[23,18,0.5226476461727136],[23,19,0.5075747867375697],[23,20,0.5362658742812834],[23,21,0.5140642487302184],[23,22,0.5135792969737251],[23,23,0.5],[23,24,0.49261971349736994],[23,25,0.4800502896278241],[23,26,0.4783832271572331],[23,27,0.4754562452520776],[23,28,0.4945191627884656],[23,29,0.4291502938746136],[24,0,0.5902174252211929],[24,1,0.6941032764581923],[24,2,0.8041453940202311],[24,3,0.5037948266798415],[24,4,0.709545458179858],[24,5,0.6794693615558265],[24,6,0.604902891471743],[24,7,0.5791663709623422],[24,8,0.6761624430908381],[24,9,0.6734362506635939],[24,10,0.5195429035546436],[24,11,0.5092756905364325],[24,12,0.5458848624565872],[24,13,0.6037312775952832],[24,14,0.5662609472325327],[24,15,0.628362940283436],[24,16,0.5059338295764728],[24,17,0.5569055071428183],[24,18,0.5609415989505888],[24,19,0.5045000689812156],[24,20,0.5062585041520318],[24,21,0.5474969858828671],[24,22,0.5327352848096678],[24,23,0.5163734770045689],[24,24,0.5],[24,25,0.4935408595457064],[24,26,0.48140673415122726],[24,27,0.4814902752611262],[24,28,0.47934037282931735],[24,29,0.4750020272662917],[25,0,0.7679726439515056],[25,1,0.6981083551292198],[25,2,0.688509038709859],[25,3,0.5182032345957973],[25,4,0.5429318773826238],[25,5,0.6946710599702982],[25,6,0.718372274153414],[25,7,0.6236108174560029],[25,8,0.5998251478608019],[25,9,0.5776134675128372],[25,10,0.6200276740598095],[25,11,0.6294325679215383],[25,12,0.5097571731787011],[25,13,0.6029088889340414],[25,14,0.5894409486192884],[25,15,0.6343266633211653],[25,16,0.5613108477161907],[25,17,0.5215049796886688],[25,18,0.5950023472059951],[25,19,0.5356436363494254],[25,20,0.5219053019707333],[25,21,0.5220081203726896],[25,22,0.5301774115340753],[25,23,0.5190581426283197],[25,24,0.5027795920667427],[25,25,0.5],[25,26,0.4851883939835955],[25,27,0.47254308694713076],[25,28,0.4935996998984671],[25,29,0.4873045501801161],[26,0,0.7743442096456326],[26,1,0.8166459550538362],[26,2,0.6764016376680344],[26,3,0.7839342302784251],[26,4,0.776991872287824],[26,5,0.6372154471792482],[26,6,0.6994139755171963],[26,7,0.5501330413287323],[26,8,0.7220597202705842],[26,9,0.5989674456861059],[26,10,0.7004916408061476],[26,11,0.5026160768322001],[26,12,0.6214040264879791],[26,13,0.6603472686984417],[26,14,0.576623728722748],[26,15,0.6241027830221308],[26,16,0.5420589199547848],[26,17,0.5577924449163099],[26,18,0.5873059462697197],[26,19,0.5306179796409324],[26,20,0.5819401532070851],[26,21,0.5257397011773612],[26,22,0.5194712409450569],[26,23,0.5376312744468918],[26,24,0.5278900227858392],[26,25,0.5086962234486584],[26,26,0.5],[26,27,0.4976281763902111],[26,28,0.48756341300456346],[26,29,0.4915673768609172],[27,0,0.5794486928228127],[27,1,0.8340203614198257],[27,2,0.6072437208506675],[27,3,0.7344624510104949],[27,4,0.557846649008258],[27,5,0.5363564914487887],[27,6,0.6169509985816498],[27,7,0.6319595302660722],[27,8,0.7390573336629926],[27,9,0.5481691069055307],[27,10,0.6342299378226531],[27,11,0.7407883554718853],[27,12,0.7246965530467159],[27,13,0.5236508441270447],[27,14,0.6146710052271279],[27,15,0.5236420127338055],[27,16,0.5213590079232011],[27,17,0.6569070463145834],[27,18,0.6440298551443959],[27,19,0.6214278957552978],[27,20,0.5883332606825017],[27,21,0.5034295591750924],[27,22,0.5195104707541482],[27,23,0.5386142683943183],[27,24,0.5168461367049737],[27,25,0.512344992027656],[27,26,0.5090561927793554],[27,27,0.5],[27,28,0.49333965222029597],[27,29,0.4951718462190607],[28,0,0.6525467711676087],[28,1,0.7813588179850711],[28,2,0.78146533441335],[28,3,0.7639344226491558],[28,4,0.6173420498652021],[28,5,0.7307658657582314],[28,6,0.7362177201769994],[28,7,0.5108424067087868],[28,8,0.7631613624086309],[28,9,0.6315705450870883],[28,10,0.7541418610207655],[28,11,0.5614633817880422],[28,12,0.5488466509733845],[28,13,0.6554108902951632],[28,14,0.6967751265143816],[28,15,0.6915445408095315],[28,16,0.6754520404245158],[28,17,0.6344937998487148],[28,18,0.6372891598678855],[28,19,0.5133054899209566],[28,20,0.6220908863666891],[28,21,0.5686010610810123],[28,22,0.5986715330914513],[28,23,0.5266986985563327],[28,24,0.5212386909381116],[28,25,0.5330476444402892],[28,26,0.5027271392842542],[28,27,0.5022120477271483],[28,28,0.5],[28,29,0.4953612920259185],[29,0,0.6533718079371249],[29,1,0.5280650201343329],[29,2,0.5166593329999877],[29,3,0.5210441320008647],[29,4,0.5359916111276288],[29,5,0.7014497618336928],[29,6,0.5097138521517695],[29,7,0.7930340453194948],[29,8,0.6222170444195116],[29,9,0.6939970380391873],[29,10,0.7376829095370696],[29,11,0.6040741724917583],[29,12,0.6259693791911682],[29,13,0.5614286290552675],[29,14,0.5507240026959059],[29,15,0.5349900593214237],[29,16,0.6403324792892862],[29,17,0.515862430916789],[29,18,0.5882857035941157],[29,19,0.6093183171035025],[29,20,0.5247876023375595],[29,21,0.6107719609249599],[29,22,0.5418247654148485],[29,23,0.5292187914250013],[29,24,0.5600522770912232],[29,25,0.5023781407818102],[29,26,0.5124246951084723],[29,27,0.5132232583312825],[29,28,0.5117366066607412],[29,29,0.5]],"itemStyle":{"emphasis":{"borderColor":"#333","borderWidth":2}},"progressive":1000,"animation":false}]});
};</script></div>
<p>Note the slider control and the tooltips.</p>
<p>Here is an example with an actual correlation matrix.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb13"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">let</span> [columns-for-correlations [<span class="at">:sepal-length</span> <span class="at">:sepal-width</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">:petal-length</span> <span class="at">:petal-width</span>]</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>      correlations (<span class="kw">-&gt;</span> noj-book.datasets/iris</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                       (correlations-dataset columns-for-correlations)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                       (tc/select-columns [<span class="at">:coli</span> <span class="at">:colj</span> <span class="at">:corr-round</span>])</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>                       tc/rows)]</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  (echarts-heatmap {<span class="at">:xyz-data</span> correlations</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">:xs</span> columns-for-correlations</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">:ys</span> columns-for-correlations</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">:min</span> -<span class="dv">1</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">:max</span> <span class="dv">1</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">:series-name</span> <span class="st">"correlation"</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div style="height:400px;width:100%;"><script>
{
  var myChart = echarts.init(document.currentScript.parentElement);
  myChart.setOption({"tooltip":{},"xAxis":{"type":"category","data":["sepal-length","sepal-width","petal-length","petal-width"]},"yAxis":{"type":"category","data":["sepal-length","sepal-width","petal-length","petal-width"]},"visualMap":{"min":-1,"max":1,"calculable":true,"splitNumber":8,"inRange":{"color":["#313695","#4575b4","#74add1","#abd9e9","#e0f3f8","#ffffbf","#fee090","#fdae61","#f46d43","#d73027","#a50026"]}},"series":[{"name":"correlation","type":"heatmap","data":[["sepal-length","sepal-length",1.00],["sepal-length","sepal-width",-0.12],["sepal-length","petal-length",0.87],["sepal-length","petal-width",0.82],["sepal-width","sepal-length",-0.12],["sepal-width","sepal-width",1.00],["sepal-width","petal-length",-0.43],["sepal-width","petal-width",-0.37],["petal-length","sepal-length",0.87],["petal-length","sepal-width",-0.43],["petal-length","petal-length",1.00],["petal-length","petal-width",0.96],["petal-width","sepal-length",0.82],["petal-width","sepal-width",-0.37],["petal-width","petal-length",0.96],["petal-width","petal-width",1.00]],"itemStyle":{"emphasis":{"borderColor":"#333","borderWidth":2}},"progressive":1000,"animation":false}]});
};</script></div>
<p>TODO: Improve the layout so that the slider control does not overlap the labels.</p>
</section>
<section id="drawing-a-heatmap-using-cljplot" class="level2" data-number="10.4">
<h2 data-number="10.4" class="anchored" data-anchor-id="drawing-a-heatmap-using-cljplot"><span class="header-section-number">10.4</span> Drawing a heatmap using cljplot</h2>
<p>coming soon</p>
</section>
<section id="drawing-a-heatmap-using-vega" class="level2" data-number="10.5">
<h2 data-number="10.5" class="anchored" data-anchor-id="drawing-a-heatmap-using-vega"><span class="header-section-number">10.5</span> Drawing a heatmap using Vega</h2>
<p>coming soon</p>
<div style="background-color:grey;height:2px;width:100%;"></div>
<div><pre><small><small>source: <a href="https://github.com/scicloj/noj/blob/main/notebooks/noj_book/visualizing_correlation_matrices.clj">notebooks/noj_book/visualizing_correlation_matrices.clj</a></small></small></pre></div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./noj_book.interactions_ols.html" class="pagination-link" aria-label="Ordinary least squares with interactions">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Ordinary least squares with interactions</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->




</body></html>